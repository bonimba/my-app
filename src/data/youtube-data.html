<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">

<dom-module id="youtube-data">

    <template>

        <iron-ajax
                auto
                url="[[url]]"
                params='[[computedParameters]]'
                handle-as="json"
                last-response="{{response}}"
        ></iron-ajax>

    </template>

    <script>
        Polymer({
            is: 'youtube-data',
            properties: {
                base : {
                    type: String,
                    value: "https://www.googleapis.com/youtube/v3"
                },
                specific: {
                    type: String,
                    value: 'channels'
                },
                url: {
                    type: String,
                    computed: 'computeUrl(base, specific)'
                },
                params : {
                    type: Object,
                    value: {},
                    notify: true
                },

                youtubeKey: {
                    type: String,
                    value: "AIzaSyDgsvYtLz-BuMYSLt_Zzhde5W9Kl1BnbLA",
                    readOnly: true
                },

                computedParameters: {
                    type: Object,
                    computed: 'computeParameters(params, youtubeKey)',
                    notify: true
                },
                response: {
                    type: Object,
                    notify: true,
                    reflectToAttribute: true,
                    readOnly: true
                }
            },

            computeHeader: function(accessToken){
                if(accessToken)
                return {"Authorization": "Bearer "+accessToken};
                return '';
            },

            computeUrl: function(base, specific){
                return [base, specific].join("/");
            },

            computeParameters: function(params, youtubeKey){
                var parameters = params;
                parameters.key = youtubeKey;

                return parameters;
            }

        });
    </script>
</dom-module>
